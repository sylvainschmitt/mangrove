[["index.html", "Mangrove Mangrove exploratory analyses. Preface", " Mangrove Mangrove exploratory analyses. Sylvain Schmitt 2021-07-12 Preface stability-wip Mangrove exploratory analyses. Have a nice reading. Sylvain "],["introduction.html", "Introduction 0.1 Background 0.2 Experiment design 0.3 Question", " Introduction 0.1 Background Avicennia germinans in French Guiana is capable of extraordinarily early flowering (after just 3 months) and extraordinarily big growth (they grow to be 15m tall). Elsewhere in the species distribution trees do not flower before several years and only grow to a few meters tall. Avicennia conquers newly formed mud banks pretty much in a single wave, therefore all plants are more or less the same age (like Cecropia). And mud-banks have an unpredictable life-span (few days to few decades). They grow hyper-densely, so very strong competition. This should pose two opposing selective pressures: early flowering favored in short lived mud-banks, fast growth and competitive advantage in long lived mud-banks. My hypothesis is that there may be genetic predisposition to either early flowering or fast growth. Niklas Tysklind 0.2 Experiment design To have a first look at this question, we went to the mud-banks in Awala-Yalimapo, established 12 plots of 5x5m with varying densities and average heights. We measured height, diameter, branching of all Avicennia trees (i.e. somatic growth effort) in each plot, then counted all inflorescence and fruits in each tree (i.e. reproductive growth effort). We got a total of ca. 400 trees. To get an estimate of the effect of competition in each tree we measured the distances to the 3 nearest neighbours of any species. Niklas Tysklind 0.3 Question Are individuals from Avicennia germinans structured in two distinct populations? "],["data.html", "Chapter 1 Data 1.1 Variables 1.2 Model types 1.3 Co-variations 1.4 Relations 1.5 Conclusion", " Chapter 1 Data This chapter introduce and explore explanatory variables correlations and relations with response variables. 1.1 Variables date: date DD/MM/YYYYY time: time HH plot: plot id: tree height: tree height in m d1: tree diameter at the base in mm d2: second tree diameter at the the base orthogonal to d1 in mm diameter: mean tree diameter in mm (\\(\\frac{d1+d2}{2}\\)) branches: number of branches in the tree fruits: number of fruits in the tree flowers: number of flowers in the tree pflower: presence of flower in the tree (0/1) nci1: distance to the closest tree in cm nci2: distance to the second closest tree in cm nci3: distance to the third closest tree in cm nci: mean distance to the three closest trees in cm density: plot tree density in \\(trees.m^2\\) age: maximum age in months shore: distance from shore in m. Distance from the shore is potentially correlated with two important non-measured variables: 1) age since the precise location in the mud-bank became available to the seed rain (nearer plots are likely older than further plots, though not necessarily); and 2) the amount of hours the sea is above that point (nearer plots are likely to be submerged fewer hours). soil: qualitative approximate from mostly sandy (1) to deeply muddy (4) openness: qualitative approximate of light that reached the soil from a not densely covered/ lot of light (1) to very densely covered and very little light reaching the bottom (4) 1.2 Model types Lognormal regressions: height and diameter are positive continuous measurements and followed a lognormal distribution Poisson exponential regressions: branches, fruits and flowers are count data and followed a Poisson distribution Bernoulli logistic regressions: pflower is binary and followed a Bernoulli distribution 1.3 Co-variations Figures 1.1 and 1.2 showed variables co-variations among them. There are a lot of positive and negative co-variations, as indicated by Niklas Tysklind preliminary results. Growth and (height, diameter, and branches) are positively correlated to reproduction (fruits, flower, pflowers), which may simplify the analyses if we find similar results for the two performance traits. NCI was correlated to both growth and reproduction. Soil was negatively correlated to growth. Openness was positively correlated to growth. Due to the high correlation between density and age (\\(r=0.74\\), 1.1), we will drop age from further analyses (density is more accurate). Figure 1.1: Variables correlations. Pearson’s r below the diagonal and corresponding color above the diagonal. Figure 1.2: Principal component analysis of variables. 1.4 Relations We explored relations among variables using: Response variables: Growth: height, diameter, and branches Reproduction: fruits, flowers and pflower Explanatory variables: Continuous: nci, density, age, and shore Qualitative: soil, and openness Random effects: plot Figures 1.3, 1.4 and 1.5 showed explanatory variables relation to response variables. All explanatory variables had a significant linear effect on all response variables (Fig. 1.5). Explanatory variables explained 8 to 15% of variation in reproductive traits and 41 to 63% of variation in growth traits (Tab. ??). Figure 1.3: Relations for continuous explanatory variables. Figure 1.4: Relations for categorial explanatory variables. Figure 1.5: Variable importance calculated with an out-of-bag method applied on a random forest. Variable importance is represented by the mean increase in mean square error (MSE). 1.5 Conclusion We already found a lot of variation explained, but there are still a lot of unexplained variation, especially for reproduction. In the final model, we can add plot, date and hours random effects to remove plot, climate and weather effects from residual variation, and get closer to the individual variation. Then we may be able to identify outliers with high/slow growth/reproduction. "],["exploratory-models.html", "Chapter 2 Exploratory models", " Chapter 2 Exploratory models This chapter develop all the models used to explore growth and reproductive variation linked to ontogeny and environment. We used following variables: Response variables: Growth: height (lognormal), diameter (lognormal), and branches (Poisson) Reproduction: fruits (Poisson), flowers (Poisson), and pflower (Bernoulli) Explanatory variables: Continuous: nci, density, and shore Qualitative: soil, and openness Random effects: plot Most variation was related to openness, soil and neighbours (Fig. 2.1). Nevertheless, the residual showed a high variation (Fig. 2.1) and structure for pflower (Fig. 2.2). Figure 2.1: Variance partitionning for all models. Figure 2.2: Residual for all models. "],["hierarchical-full.html", "Chapter 3 Hierarchical full 3.1 Baseline model 3.2 Hierarchical model 3.3 Hierarchical model with covariable", " Chapter 3 Hierarchical full 3.1 Baseline model We start with a simple model in which we aim to model the number of flowers/fruits \\(y_{i,p}\\) of each individual \\(i\\) in plot \\(p\\) as a function of its \\(height\\) and neighbourhood crowding \\(nci\\) with a random effect on the plot, such as: \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p + \\beta*nci_i)\\] \\[\\mu_p \\sim \\mathcal N (\\mu, \\sigma)\\] 3.1.1 Flowers 3.1.2 Fruits 3.2 Hierarchical model Let’s assume there are two genetically distinct types of individuals that can be differentiated based on their flowering date : early or late flowering. We want to identify individuals with the genetic potential of flowering earlier. Let’s p be the probability of a late individual i and 1−p the probability of an early individual. \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p^l + \\beta*nci_i)\\] \\[\\mu_p^l \\sim \\mathcal N (\\mu^l, \\sigma)\\] \\[l\\in{1,2}|z_{i,p}\\sim\\mathcal B(p)\\] 3.2.1 Flowers elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.000 0.00 -10790.14 1962.935 4546.560 768.1791 21580.28 3925.870 model1 -9587.187 1796.41 -20377.33 3343.991 1669.282 303.8157 40754.65 6687.983 3.2.2 Fruits elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.0000 0.0000 -855.356 94.0355 132.7910 28.66924 1710.712 188.0710 model1 -910.8263 184.2343 -1766.182 249.5163 160.5949 31.22343 3532.365 499.0326 3.3 Hierarchical model with covariable \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p^l + \\beta*nci_i)\\] \\[\\mu_p^l \\sim \\mathcal N (\\mu^l, \\sigma)\\] \\[l\\in{1,2}|z_{i,p}\\sim\\mathcal B(\\eta_0 + \\gamma*shore_p)\\] 3.3.1 Flowers elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.000 0.0000 -10790.14 1962.935 4546.560 768.1791 21580.28 3925.870 model3 -1498.908 693.0721 -12289.05 1957.840 7986.893 1814.2842 24578.09 3915.681 model1 -9587.187 1796.4100 -20377.33 3343.991 1669.282 303.8157 40754.65 6687.983 3.3.2 Fruits elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.0000000 0.000000 -855.3560 94.03550 132.7910 28.66924 1710.712 188.0710 model3 -0.4717859 1.800428 -855.8278 94.44493 134.9296 30.39393 1711.656 188.8899 model1 -910.8262819 184.234312 -1766.1823 249.51628 160.5949 31.22343 3532.365 499.0326 "],["hierarchical-positive.html", "Chapter 4 Hierarchical positive 4.1 Baseline model 4.2 Hierarchical model 4.3 Hierarchical model with covariable", " Chapter 4 Hierarchical positive 4.1 Baseline model We start with a simple model in which we aim to model the number of flowers/fruits \\(y_{i,p}\\) of each individual \\(i\\) in plot \\(p\\) as a function of its \\(height\\) and neighbourhood crowding \\(nci\\) with a random effect on the plot, such as: \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p + \\beta*nci_i)\\] \\[\\mu_p \\sim \\mathcal N (\\mu, \\sigma)\\] 4.1.1 Flowers 4.1.2 Fruits 4.2 Hierarchical model Let’s assume there are two genetically distinct types of individuals that can be differentiated based on their flowering date : early or late flowering. We want to identify individuals with the genetic potential of flowering earlier. Let’s p be the probability of a late individual i and 1−p the probability of an early individual. \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p^l + \\beta*nci_i)\\] \\[\\mu_p^l \\sim \\mathcal N (\\mu^l, \\sigma)\\] \\[l\\in{1,2}|z_{i,p}\\sim\\mathcal B(p)\\] 4.2.1 Flowers elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.00 0.000 -6092.683 579.442 2784.932 389.1313 12185.37 1158.884 model1 -6982.19 2324.704 -13074.873 2562.634 1400.627 266.2230 26149.75 5125.268 4.2.2 Fruits elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.0000 0.00000 -442.6620 36.69667 41.51393 9.921281 885.324 73.39335 model1 -478.8201 94.15142 -921.4821 114.01356 120.64435 20.316463 1842.964 228.02712 4.2.3 Together \\[flowers_{i,p} \\sim \\mathcal Plog (\\mu Fl_p^l + \\beta Fl*nci_i)\\] \\[fruits_{i,p} \\sim \\mathcal Plog (\\mu Fr_p^l + \\beta Fr*nci_i)\\] \\[\\mu Fl_p^l \\sim \\mathcal N (\\mu Fl ^l, \\sigma)\\] \\[\\mu Fr_p^l \\sim \\mathcal N (\\mu Fr ^l, \\sigma)\\] \\[l\\in{1,2}|z_{i,p}\\sim\\mathcal B(p)\\] 4.3 Hierarchical model with covariable \\[y_{i,p} \\sim \\mathcal Plog (\\mu_p^l + \\beta_1*height+ \\beta_2*nci_i)\\] \\[\\mu_p^l \\sim \\mathcal N (\\mu^l, \\sigma)\\] \\[l\\in{1,2}|z_{i,p}\\sim\\mathcal B(\\eta_0 + \\gamma_1*height + \\gamma_2*shore_p)\\] 4.3.1 Flowers elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model3 0.000 0.0000 -4997.571 502.3085 1466.752 195.7712 9995.142 1004.617 model2 -1095.112 363.2622 -6092.683 579.4420 2784.932 389.1313 12185.366 1158.884 model1 -8077.302 2340.8472 -13074.873 2562.6338 1400.627 266.2230 26149.746 5125.268 4.3.2 Fruits elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic model2 0.000000 0.000000 -442.6620 36.69667 41.51393 9.921281 885.3240 73.39335 model3 -5.245219 7.272549 -447.9072 38.33183 51.92448 11.002669 895.8145 76.66367 model1 -478.820104 94.151421 -921.4821 114.01356 120.64435 20.316463 1842.9642 228.02712 "],["appendix-1-anibarosa.html", "A Appendix 1: Anibarosa A.1 Data A.2 Model", " A Appendix 1: Anibarosa A.1 Data data &lt;- read_tsv(&quot;data/anibarosa_oil_prod_2020.txt&quot;) %&gt;% dplyr::rename(height = `H`, provenance = `Prov`, border = `Bord`) %&gt;% mutate(border = as.numeric(border == &quot;OUI&quot;)) g1 &lt;- ggplot(data, aes(height, Mean)) + geom_point() + geom_errorbar(aes(ymin = Mean-SD, ymax = Mean+SD)) + geom_smooth(method = &quot;lm&quot;) g2 &lt;- reshape2::melt(data, c(&quot;ID&quot;, &quot;Mean&quot;, &quot;CV&quot;, &quot;SD&quot;)) %&gt;% filter(variable != &quot;height&quot;) %&gt;% ggplot(aes(value, Mean)) + geom_boxplot() + facet_wrap(~variable, scales = &quot;free&quot;) cowplot::plot_grid(g1, g2) Figure A.1: Anibarosa oil production in 2020 with height, provenance and border effect. A.2 Model lm(Mean ~ height + provenance + as.factor(border), data) %&gt;% anova() %&gt;% as.data.frame() %&gt;% rownames_to_column(&quot;parameter&quot;) %&gt;% mutate(TotSq = sum(`Sum Sq`)) %&gt;% mutate(pctNum = round(`Sum Sq` / TotSq * 100)) %&gt;% mutate(pctTxt = paste0(pctNum, &quot;%&quot;)) %&gt;% mutate(parameter = ifelse(parameter == &quot;Residuals&quot;, &quot;residuals&quot;, parameter)) %&gt;% ggplot(aes(x = 0, fill = parameter)) + geom_col(aes(y = pctNum)) + geom_text(aes(y = pctNum, label = pctTxt), col = &quot;white&quot;, position = position_stack(vjust = .5)) + theme(axis.title.x = element_blank(), axis.title.y = element_blank(), axis.line.x = element_blank(), axis.ticks.x = element_blank()) + viridis::scale_fill_viridis(expression(sigma^2), discrete = T) Figure A.2: Variance partitionning. "],["references.html", "References", " References "]]
